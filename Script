document.getElementById("dataUr").addEventListener("input", function () {
  let value = this.value;

  value = value.replace(/\D/g, ""); // tylko cyfry

  if (value.length > 8) {
    value = value.slice(0, 8);
  }

  this.value = value;
});

// Funkcja redukująca sumę cyfr do jednej cyfry
function redukujDoJednejCyfry(liczba) {
  while (liczba > 9) {
    let temp = 0;
    for (let char of liczba.toString()) {
      temp += parseInt(char, 10);
    }
    liczba = temp;
  }
  return liczba;
}

// Mapowanie liter na wartości 1–9
function wartoscLiterowa(imieNazwisko) {
  const mapaLiter = {
    A: 1, J: 1, S: 1,
    B: 2, K: 2, T: 2,
    C: 3, L: 3, U: 3,
    D: 4, M: 4, V: 4,
    E: 5, N: 5, W: 5,
    F: 6, O: 6, X: 6,
    G: 7, P: 7, Y: 7,
    H: 8, Q: 8, Z: 8,
    I: 9, R: 9
  };

  let suma = 0;
  for (let litera of imieNazwisko.toUpperCase()) {
    if (mapaLiter[litera]) {
      suma += mapaLiter[litera];
    }
  }
  return redukujDoJednejCyfry(suma);
}

// Główna funkcja obliczająca liczbę przeznaczenia
document.getElementById("przyciskOblicz").addEventListener("click", function () {
  const imieNazwisko = document.getElementById("imieNazwisko").value.trim();
  const dataUr = document.getElementById("dataUr").value.trim();
  const wynikDiv = document.getElementById("wynik");

  if (dataUr === "") {
    wynikDiv.textContent = "Wpisz datę urodzenia!";
    return;
  }

  // Suma z daty urodzenia
  let sumaDaty = 0;
  for (let char of dataUr) {
    sumaDaty += parseInt(char, 10);
  }
  const liczbaZDaty = redukujDoJednejCyfry(sumaDaty);

  // Suma z imienia i nazwiska
  const liczbaZImienia = imieNazwisko ? wartoscLiterowa(imieNazwisko) : 0;

  // Połączenie obu wartości
  let wynikLaczny = liczbaZDaty + liczbaZImienia;
  const liczbaPrzeznaczenia = redukujDoJednejCyfry(wynikLaczny);

  let tekstWyniku = imieNazwisko
    ? `${imieNazwisko}, Twoja liczba przeznaczenia to: ${liczbaPrzeznaczenia}`
    : `Twoja liczba przeznaczenia to: ${liczbaPrzeznaczenia}`;

  wynikDiv.textContent = tekstWyniku;
});
